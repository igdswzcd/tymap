{"version":3,"file":"index.js","sources":["pages/index/index.uvue","../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudXZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 主要内容区域 -->\r\n\t\t<view class=\"main-content\">\r\n\t\t\t<!-- 楼栋可视化区域 -->\r\n\t\t\t<view\r\n\t\t\t\tclass=\"visualization-area\"\r\n\t\t\t\t@touchstart=\"handleTouchStart\"\r\n\t\t\t\t@touchend=\"handleTouchEnd\"\r\n\t\t\t>\r\n\t\t\t\t<view\r\n\t\t\t\t\tclass=\"areas-container\"\r\n\t\t\t\t\t:style=\"{ transform: `translateX(${currentArea === 'flat' ? '0' : '-50%'})` }\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<!-- 平层区 -->\r\n\t\t\t\t\t<view\r\n\t\t\t\t\t\tclass=\"area-content flat-area\"\r\n\t\t\t\t\t\t:class=\"{ 'secondary-area': currentArea === 'villa' }\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\tv-for=\"row in flatRows\"\r\n\t\t\t\t\t\t\t:key=\"row.number\"\r\n\t\t\t\t\t\t\tclass=\"row-container\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\t\tv-for=\"building in row.buildings\"\r\n\t\t\t\t\t\t\t\t:key=\"building.building\"\r\n\t\t\t\t\t\t\t\tclass=\"building-block flat-building\"\r\n\t\t\t\t\t\t\t\t@tap=\"onBuildingTap(building)\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<Dice3D\r\n\t\t\t\t\t\t\t\t\t:disabled=\"!building.isOpen\"\r\n\t\t\t\t\t\t\t\t\t:buildingNumber=\"building.building\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- 中间的箭头 -->\r\n\t\t\t\t\t<view\r\n\t\t\t\t\t\tclass=\"area-switch-wrapper\"\r\n\t\t\t\t\t\t:class=\"{ 'left-position': currentArea === 'villa' }\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\tclass=\"area-switch\"\r\n\t\t\t\t\t\t\t:class=\"{\r\n\t\t\t\t\t\t\t\t'point-right': currentArea === 'villa',\r\n\t\t\t\t\t\t\t\t'animating': isAnimating\r\n\t\t\t\t\t\t\t}\"\r\n\t\t\t\t\t\t\t@tap=\"switchArea\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<text class=\"switch-arrow\">→</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- 别墅区 -->\r\n\t\t\t\t\t<view\r\n\t\t\t\t\t\tclass=\"area-content villa-area\"\r\n\t\t\t\t\t\t:class=\"{ 'secondary-area': currentArea === 'flat' }\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\tv-for=\"row in villaRows\"\r\n\t\t\t\t\t\t\t:key=\"row.number\"\r\n\t\t\t\t\t\t\tclass=\"row-container\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\t\tv-for=\"building in row.buildings\"\r\n\t\t\t\t\t\t\t\t:key=\"building.building\"\r\n\t\t\t\t\t\t\t\tclass=\"building-block villa-building\"\r\n\t\t\t\t\t\t\t\t@tap=\"onBuildingTap(building)\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Dice3D\r\n\t\t\t\t\t\t\t\t\t:disabled=\"!building.isOpen\"\r\n\t\t\t\t\t\t\t\t\t:buildingNumber=\"building.building\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"opr-area\"></view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup lang=\"uts\">\r\nimport { ref, reactive, onMounted, computed } from 'vue'\r\nimport { generateBuildings, getBuildingsByRow, getAllRows } from '@/utils/buildingData.js'\r\nimport Dice3D from '@/components/Dice3D.uvue'\r\n\r\n// 状态管理\r\nconst currentArea = ref<'flat' | 'villa'>('flat')\r\nconst touchStartX = ref(0)\r\nconst touchStartTime = ref(0)\r\nconst isAnimating = ref(false)\r\n\r\n// 生成楼栋数据\r\nconst allBuildings = generateBuildings()\r\nconst flatBuildings = allBuildings.filter(b => b.type === 'flat')\r\nconst villaBuildings = allBuildings.filter(b => b.type === 'villa')\r\n\r\n// 计算行数据\r\nconst flatRows = computed(() => {\r\n\tconst rows: Array<{ number: number; buildings: any[] }> = []\r\n\tconst maxRow = Math.max(...flatBuildings.map(b => b.row))\r\n\r\n\tfor (let i = 0; i <= maxRow; i++) {\r\n\t\tconst rowBuildings = flatBuildings.filter(b => b.row === i)\r\n\t\tif (rowBuildings.length > 0) {\r\n\t\t\trows.push({\r\n\t\t\t\tnumber: i,\r\n\t\t\t\tbuildings: rowBuildings.sort((a, b) => a.building - b.building)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\treturn rows\r\n})\r\n\r\nconst villaRows = computed(() => {\r\n\tconst rows: Array<{ number: number; buildings: any[] }> = []\r\n\tconst maxRow = Math.max(...villaBuildings.map(b => b.row))\r\n\r\n\tfor (let i = 0; i <= maxRow; i++) {\r\n\t\tconst rowBuildings = villaBuildings.filter(b => b.row === i)\r\n\t\tif (rowBuildings.length > 0) {\r\n\t\t\trows.push({\r\n\t\t\t\tnumber: i,\r\n\t\t\t\tbuildings: rowBuildings.sort((a, b) => a.building - b.building)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\treturn rows\r\n})\r\n\r\n\r\n// 触摸事件处理\r\nconst handleTouchStart = (e: any) => {\r\n\tif (e.touches && e.touches[0]) {\r\n\t\ttouchStartX.value = e.touches[0].clientX\r\n\t\ttouchStartTime.value = Date.now()\r\n\t}\r\n}\r\n\r\nconst handleTouchEnd = (e: any) => {\r\n\tconst touchEndTime = Date.now()\r\n\tconst touchDuration = touchEndTime - touchStartTime.value\r\n\r\n\t// 检查changedTouches是否存在\r\n\tif (e.changedTouches && e.changedTouches[0]) {\r\n\t\tconst touchEndX = e.changedTouches[0].clientX\r\n\t\tconst deltaX = touchEndX - touchStartX.value\r\n\r\n\t\t// 判断滑动方向和距离\r\n\t\tif (Math.abs(deltaX) > 50 && touchDuration < 500) {\r\n\t\t\tif (deltaX > 0 && currentArea.value === 'villa') {\r\n\t\t\t\t// 向右滑动，切换到平层区\r\n\t\t\t\tcurrentArea.value = 'flat'\r\n\t\t\t} else if (deltaX < 0 && currentArea.value === 'flat') {\r\n\t\t\t\t// 向左滑动，切换到别墅区\r\n\t\t\t\tcurrentArea.value = 'villa'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// 楼栋点击事件\r\nconst onBuildingTap = (building: any) => {\r\n\tuni.__f__('log','at pages/index/index.uvue:169','点击楼栋:', building)\r\n\tif (!building.isOpen) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: `${building.building}栋 (未开放)`,\r\n\t\t\ticon: 'none'\r\n\t\t})\r\n\t} else {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: `${building.building}栋`,\r\n\t\t\ticon: 'none'\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// 切换区域\r\nconst switchArea = () => {\r\n\tisAnimating.value = true\r\n\tcurrentArea.value = currentArea.value === 'flat' ? 'villa' : 'flat'\r\n\r\n\t// 动画结束后重置状态\r\n\tsetTimeout(() => {\r\n\t\tisAnimating.value = false\r\n\t}, 1000)\r\n}\r\n\r\n// 页面导航\r\nconst navigateTo = (page: string) => {\r\n\tif (page === 'statistics') {\r\n\t\tuni.navigateTo({\r\n\t\t\turl: '/pages/statistics/statistics'\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// 生命周期\r\nonMounted(() => {\r\n\tuni.__f__('log','at pages/index/index.uvue:205','楼栋视图初始化')\r\n})\r\n</script>\r\n\r\n<style>\r\n.container {\r\n\theight: 100%;\r\n\tbackground-color: #f0f0f0;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n\tdisplay: flex;\r\n}\r\n\r\n.main-content {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\talign-items: center;\r\n\theight: 80%;\r\n\toverflow: hidden;\r\n\tflex: 1;\r\n}\r\n.opr-area {\r\n\twidth: 100%;\r\n\theight: 200rpx;\r\n}\r\n\r\n.area-switch-wrapper {\r\n\theight: 100%;\r\n\tleft: calc(50% - 75rpx);\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tz-index: 10;\r\n\ttransition: left 1s cubic-bezier(0.4, 0, 0.6, 1);\r\n}\r\n\r\n.area-switch-wrapper.left-position {\r\n\tleft: calc(50% + 5rpx);\r\n}\r\n\r\n.area-switch {\r\n\tbackground: rgba(255, 255, 255, 0.9);\r\n\twidth: 70rpx;\r\n\theight: 70rpx;\r\n\tborder-radius: 50%;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tbox-shadow: 0 2rpx 10rpx rgba(0,0,0,0.2);\r\n\ttransition: all 1s cubic-bezier(0.4, 0, 0.6, 1);\r\n}\r\n\r\n.area-switch.point-right .switch-arrow {\r\n\ttransform: rotate(180deg);\r\n}\r\n\r\n.area-switch.animating {\r\n\tanimation: opacityPulse 1s cubic-bezier(0.4, 0, 0.6, 1);\r\n}\r\n\r\n@keyframes opacityPulse {\r\n\t0% { opacity: 1; }\r\n\t50% { opacity: 0.2; }\r\n\t100% { opacity: 1; }\r\n}\r\n\r\n.switch-arrow {\r\n\tfont-size: 40rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #3cc51f;\r\n\ttransition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);\r\n}\r\n\r\n.visualization-area {\r\n\tflex: 1;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n\tposition: relative;\r\n}\r\n\r\n.areas-container {\r\n\twidth: 200%;\r\n\theight: 100%;\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\ttransition: transform 1s cubic-bezier(0.4, 0, 0.6, 1);\r\n\twill-change: transform;\r\n}\r\n\r\n.area-content {\r\n\theight: 100%;\r\n\twidth: 50%;\r\n\tdisplay: flex;\r\n\tgap: 10rpx;\r\n\tflex-direction: column;\r\n\tjustify-content: space-between;\r\n\tpadding: 20rpx;\r\n\tbox-sizing: border-box;\r\n\ttransition: width 1s cubic-bezier(0.4, 0, 0.6, 1), opacity 1s cubic-bezier(0.4, 0, 0.6, 1);\r\n}\r\n\r\n.flat-area {\r\n\tpadding-right: 2.5%;\r\n}\r\n\r\n.villa-area {\r\n\t/* 别墅区样式 */\r\n\tpadding-left: 2.5%;\r\n}\r\n\r\n.secondary-area {\r\n\topacity: 0.2;\r\n}\r\n\r\n.row-container {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\tjustify-content: space-between;\r\n\twidth: 100%;\r\n\tflex: 1;\r\n\tgap: 10rpx;\r\n}\r\n\r\n.building-block {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tborder-radius: 8rpx;\r\n\ttransition: all 0.3s ease;\r\n\tflex: 1;\r\n\tmax-width: 35vw;\r\n}\r\n\r\n.flat-building, villa-building {\r\n\tflex: 1;\r\n}\r\n\r\n.building-block:active {\r\n\ttransform: scale(0.95);\r\n}\r\n\r\n.building-number {\r\n\tcolor: white;\r\n\tfont-size: 28rpx;\r\n\tfont-weight: bold;\r\n}\r\n\r\n</style>","import MiniProgramPage from 'D:/sakana/uniapp/uni-ty-map/pages/index/index.uvue'\nwx.createPage(MiniProgramPage)"],"names":["ref","generateBuildings","computed","uni","onMounted","MiniProgramPage"],"mappings":"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"}